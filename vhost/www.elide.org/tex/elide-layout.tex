
\definepalet
	[layout]
	[grid=kmkf-green,page=kmkf-green]

% for A4, have gaps down the sides, giving 2:3 ratio in the middle (ArchB size scaled to fit A4)
\def\PW{\dimexpr\paperheight*2/3\relax} % we're designing for a 2:3 area scaled to fit the paper

\def\GH{\dimexpr\paperheight*1/9\relax}
\def\GW{\dimexpr\PW         *1/9\relax}

% default layout
% 16cm = 8*2cm cols, 1.5cm between each
\setuplayout[
	grid=no,
	columndistance=\dimexpr\GW*1/3\relax,
	columns=6,
	backspace=2\GW,
	top=0pt,
	headerdistance=\dimexpr\GH*1/3-.4\bodyfontsize\relax,
	bottom=0pt,
	bottomspace=0pt,
	bottomdistance=0pt,
	footer=\bodyfontsize,
	footerdistance=\dimexpr\GH*1/3\relax,
	height=\dimexpr39\lineheight
		+\headerheight+\headerdistance
		+\footerheight+\footerdistance\relax,
	leftmargin=\dimexpr\GW+\GW*1/3\relax,
	leftmargindistance=0pt,
	rightmargin=\GW,
	width=\dimexpr6\GW-\GW*1/3\relax,
	topspace=0pt,
	header=\dimexpr2\GH-\GH*1/3\relax,
	leftedgedistance=0pt,
	rightedgedistance=0pt,
	leftmargindistance=\dimexpr\GW*1/3\relax,
	rightmargindistance=\dimexpr\GW*1/3\relax,
	edge=\dimexpr.5\PW-.5\paperwidth\relax]


\setupinterlinespace[small]
\setupwhitespace[halfline]

\setupcolumns[
	distance=1pt,
	balance=no]

\setupitemgroup[
	margin=1.5\bodyfontsize]

\setuptyping[
	margin=3\bodyfontsize]

% TODO: outset to page width, perhaps in columns
\setupstartstop[Aside][
	before=\blackrule,
	after=]

\setupinmargin[background=color,backgroundcolor=lightgray]
\def\hyphenatedurlseparator{â†©}

\startmode[debug]

	\input elide-geometry.tex

	\defineoverlay[cover] [\uniqueMPgraphic{cover}]
	\setupbackgrounds[page][background=cover]

\stopmode

